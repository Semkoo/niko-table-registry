{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "data-table-export-button",
  "title": "DataTable Export Button",
  "description": "Export table data to CSV with configurable options.",
  "dependencies": [
    "lucide-react"
  ],
  "registryDependencies": [
    "https://niko-table.com/r/data-table.json",
    "button"
  ],
  "files": [
    {
      "path": "src/components/niko-table/components/data-table-export-button.tsx",
      "content": "\"use client\"\n\nimport { useDataTable } from \"../core\"\nimport {\n  TableExportButton,\n  type TableExportButtonProps,\n} from \"../filters/table-export-button\"\n\nexport type DataTableExportButtonProps<TData> = Omit<\n  TableExportButtonProps<TData>,\n  \"table\"\n>\n\n/**\n * Context-aware export button component that automatically gets the table from DataTableRoot context.\n * This is the recommended way to use the export button in most cases.\n *\n * @example\n * ```tsx\n * <DataTableRoot data={data} columns={columns}>\n *   <DataTableExportButton filename=\"products\" />\n * </DataTableRoot>\n * ```\n */\nexport function DataTableExportButton<TData>({\n  ...props\n}: DataTableExportButtonProps<TData>) {\n  const { table } = useDataTable<TData>()\n\n  return <TableExportButton table={table} {...props} />\n}\n\nDataTableExportButton.displayName = \"DataTableExportButton\"\n",
      "type": "registry:component",
      "target": "components/niko-table/components/data-table-export-button.tsx"
    },
    {
      "path": "src/components/niko-table/filters/table-export-button.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport type { Table } from \"@tanstack/react-table\"\nimport { Button } from \"@/components/ui/button\"\nimport { Download } from \"lucide-react\"\n\n/**\n * Escape a cell value for CSV output.\n * Handles strings, numbers, booleans, dates, arrays, null, and undefined.\n */\nfunction escapeCsvValue(value: unknown): string {\n  if (value === null || value === undefined) return \"\"\n\n  if (value instanceof Date) {\n    return `\"${value.toISOString()}\"`\n  }\n\n  if (Array.isArray(value)) {\n    const joined = value.map(String).join(\", \")\n    return `\"${joined.replace(/\"/g, '\"\"')}\"`\n  }\n\n  if (typeof value === \"boolean\") return value ? \"true\" : \"false\"\n  if (typeof value === \"number\") return String(value)\n\n  // Default: treat as string and escape quotes\n  const str = String(value)\n  // Wrap in quotes if the value contains commas, quotes, or newlines\n  if (str.includes(\",\") || str.includes('\"') || str.includes(\"\\n\")) {\n    return `\"${str.replace(/\"/g, '\"\"')}\"`\n  }\n  return str\n}\n\nexport interface ExportTableToCSVOptions<TData> {\n  /** Filename for the exported CSV (without extension). @default \"table\" */\n  filename?: string\n  /** Column IDs to exclude from export. */\n  excludeColumns?: (keyof TData)[]\n  /** Whether to export only selected rows. @default false */\n  onlySelected?: boolean\n  /**\n   * Use human-readable labels from `column.columnDef.meta.label` as CSV\n   * header names instead of raw column IDs.\n   * @default false\n   */\n  useHeaderLabels?: boolean\n}\n\n/**\n * Core utility function to export a TanStack Table to CSV.\n * This is the base implementation that can be used directly or wrapped in components.\n *\n * @param table - The TanStack Table instance\n * @param opts - Export options\n *\n * @example\n * ```ts\n * import { exportTableToCSV } from \"@/components/niko-table/filters\"\n *\n * // Basic export\n * exportTableToCSV(table, { filename: \"users\" })\n *\n * // Export with human-readable headers\n * exportTableToCSV(table, { filename: \"users\", useHeaderLabels: true })\n *\n * // Export only selected rows\n * exportTableToCSV(table, { filename: \"selected-users\", onlySelected: true })\n * ```\n */\nexport function exportTableToCSV<TData>(\n  table: Table<TData>,\n  opts: ExportTableToCSVOptions<TData> = {},\n): void {\n  const {\n    filename = \"table\",\n    excludeColumns = [],\n    onlySelected = false,\n    useHeaderLabels = false,\n  } = opts\n\n  // Retrieve columns, filtering out excluded ones\n  const columns = table\n    .getAllLeafColumns()\n    .filter(column => !excludeColumns.includes(column.id as keyof TData))\n\n  // Build header row â€” use meta.label when available and useHeaderLabels is true\n  const headerRow = columns\n    .map(column => {\n      if (useHeaderLabels) {\n        const label = (\n          column.columnDef.meta as Record<string, unknown> | undefined\n        )?.label as string | undefined\n        return escapeCsvValue(label ?? column.id)\n      }\n      return escapeCsvValue(column.id)\n    })\n    .join(\",\")\n\n  // Column IDs for value lookup\n  const columnIds = columns.map(column => column.id)\n\n  // Build data rows\n  const rows = onlySelected\n    ? table.getFilteredSelectedRowModel().rows\n    : table.getRowModel().rows\n\n  const dataRows = rows.map(row =>\n    columnIds.map(id => escapeCsvValue(row.getValue(id))).join(\",\"),\n  )\n\n  const csvContent = [headerRow, ...dataRows].join(\"\\n\")\n\n  // Create blob and trigger download\n  const blob = new Blob([csvContent], { type: \"text/csv;charset=utf-8;\" })\n  const url = URL.createObjectURL(blob)\n  const link = document.createElement(\"a\")\n  link.setAttribute(\"href\", url)\n  link.setAttribute(\"download\", `${filename}.csv`)\n  link.style.visibility = \"hidden\"\n  document.body.appendChild(link)\n  link.click()\n  document.body.removeChild(link)\n  URL.revokeObjectURL(url)\n}\n\nexport interface TableExportButtonProps<TData> {\n  /**\n   * The table instance from TanStack Table\n   */\n  table: Table<TData>\n  /**\n   * Optional filename for the exported CSV (without extension)\n   * @default \"table\"\n   */\n  filename?: string\n  /**\n   * Columns to exclude from the export\n   */\n  excludeColumns?: (keyof TData)[]\n  /**\n   * Whether to export only selected rows\n   * @default false\n   */\n  onlySelected?: boolean\n  /**\n   * Use human-readable labels from column.columnDef.meta.label as CSV\n   * header names instead of raw column IDs.\n   * @default false\n   */\n  useHeaderLabels?: boolean\n  /**\n   * Button variant\n   * @default \"outline\"\n   */\n  variant?:\n    | \"default\"\n    | \"destructive\"\n    | \"outline\"\n    | \"secondary\"\n    | \"ghost\"\n    | \"link\"\n  /**\n   * Button size\n   * @default \"sm\"\n   */\n  size?: \"default\" | \"sm\" | \"lg\" | \"icon\"\n  /**\n   * Custom button label\n   * @default \"Export CSV\"\n   */\n  label?: string\n  /**\n   * Show icon\n   * @default true\n   */\n  showIcon?: boolean\n  /**\n   * Additional className\n   */\n  className?: string\n}\n\n/**\n * Core export button component that accepts a table prop directly.\n * Use this when you want to manage the table instance yourself.\n *\n * @example\n * ```tsx\n * const table = useReactTable({ ... })\n * <TableExportButton table={table} filename=\"products\" />\n * ```\n */\nexport function TableExportButton<TData>({\n  table,\n  filename = \"table\",\n  excludeColumns,\n  onlySelected = false,\n  useHeaderLabels = false,\n  variant = \"outline\",\n  size = \"sm\",\n  label = \"Export CSV\",\n  showIcon = true,\n  className,\n}: TableExportButtonProps<TData>) {\n  const handleExport = React.useCallback(() => {\n    exportTableToCSV(table, {\n      filename,\n      excludeColumns,\n      onlySelected,\n      useHeaderLabels,\n    })\n  }, [table, filename, excludeColumns, onlySelected, useHeaderLabels])\n\n  return (\n    <Button\n      variant={variant}\n      size={size}\n      onClick={handleExport}\n      className={className}\n    >\n      {showIcon && <Download className=\"mr-2 h-4 w-4\" />}\n      {label}\n    </Button>\n  )\n}\n\nTableExportButton.displayName = \"TableExportButton\"\n",
      "type": "registry:component",
      "target": "components/niko-table/filters/table-export-button.tsx"
    }
  ],
  "type": "registry:component"
}