{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "data-table-date-filter",
  "title": "DataTable Date Filter",
  "description": "Date picker filter supporting single date and date range selection.",
  "dependencies": [
    "lucide-react",
    "react-day-picker"
  ],
  "registryDependencies": [
    "https://niko-table.com/r/data-table.json",
    "button",
    "calendar",
    "popover",
    "separator"
  ],
  "files": [
    {
      "path": "src/components/niko-table/components/data-table-date-filter.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { useDataTable } from \"../core\"\nimport type { TableDateFilterProps } from \"../filters/table-date-filter\"\nimport { TableDateFilter } from \"../filters/table-date-filter\"\nimport { useDerivedColumnTitle } from \"../hooks/use-derived-column-title\"\nimport { FILTER_VARIANTS } from \"../lib/constants\"\n\ntype DataTableDateFilterProps<TData> = Omit<\n  TableDateFilterProps<TData>,\n  \"column\" | \"title\"\n> & {\n  /**\n   * The accessor key of the column to filter (matches column definition)\n   */\n  accessorKey: keyof TData & string\n  /**\n   * Optional title override (if not provided, will use column.meta.label)\n   */\n  title?: string\n}\n\n/**\n * A date filter component that automatically connects to the DataTable context\n * and derives the title from column metadata.\n *\n * @example - Auto-detect everything from column metadata\n * const columns: DataTableColumnDef[] = [{ accessorKey: \"releaseDate\",..., meta: { label: \"Release Date\" } },...]\n * <DataTableDateFilter accessorKey=\"releaseDate\" />\n *\n * @example - Date range filter\n * <DataTableDateFilter\n *   accessorKey=\"releaseDate\"\n *   multiple\n * />\n *\n * @example - Custom title\n * <DataTableDateFilter\n *   accessorKey=\"createdAt\"\n *   title=\"Created Date\"\n * />\n *\n * @example - Single date selection\n * <DataTableDateFilter\n *   accessorKey=\"dueDate\"\n *   title=\"Due Date\"\n *   multiple={false}\n * />\n */\n\nexport function DataTableDateFilter<TData>({\n  accessorKey,\n  title,\n  multiple,\n  trigger,\n  ...props\n}: DataTableDateFilterProps<TData>) {\n  const { table } = useDataTable<TData>()\n  const column = table.getColumn(String(accessorKey))\n\n  const derivedTitle = useDerivedColumnTitle(column, String(accessorKey), title)\n\n  // Auto-set variant in column meta if not already set\n  // This allows the auto-filterFn to be applied based on variant\n  React.useMemo(() => {\n    if (!column) return\n    const meta = (column.columnDef.meta ||= {})\n    // Only set variant if not already set (respects manual configuration)\n    if (!meta.variant) {\n      meta.variant = multiple\n        ? FILTER_VARIANTS.DATE_RANGE\n        : FILTER_VARIANTS.DATE\n    }\n  }, [column, multiple])\n\n  // Early return if column not found\n  if (!column) {\n    console.warn(\n      `Column with accessorKey \"${accessorKey}\" not found in table columns`,\n    )\n    return null\n  }\n\n  return (\n    <TableDateFilter\n      column={column}\n      title={derivedTitle}\n      multiple={multiple}\n      trigger={trigger}\n      {...props}\n    />\n  )\n}\n\n/**\n * @required displayName is required for auto feature detection\n * @see \"feature-detection.ts\"\n */\n\nDataTableDateFilter.displayName = \"DataTableDateFilter\"\n",
      "type": "registry:component",
      "target": "components/niko-table/components/data-table-date-filter.tsx"
    },
    {
      "path": "src/components/niko-table/filters/table-date-filter.tsx",
      "content": "\"use client\"\n/**\n * A dropdown menu component that allows users to toggle the visibility of table columns.\n * It uses a popover to display a list of columns with checkboxes.\n * Users can search for columns and toggle their visibility.\n */\n\nimport type { Column } from \"@tanstack/react-table\"\nimport { CalendarIcon, XCircle } from \"lucide-react\"\nimport * as React from \"react\"\nimport type { DateRange } from \"react-day-picker\"\n\nimport { Button } from \"@/components/ui/button\"\nimport { Calendar } from \"@/components/ui/calendar\"\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\"\nimport { Separator } from \"@/components/ui/separator\"\nimport { formatDate } from \"../lib/format\"\n\ntype DateSelection = Date[] | DateRange\n\nfunction getIsDateRange(value: DateSelection): value is DateRange {\n  return value && typeof value === \"object\" && !Array.isArray(value)\n}\n\nfunction parseAsDate(timestamp: number | string | undefined): Date | undefined {\n  if (!timestamp) return undefined\n  const numericTimestamp =\n    typeof timestamp === \"string\" ? Number(timestamp) : timestamp\n  const date = new Date(numericTimestamp)\n  return !Number.isNaN(date.getTime()) ? date : undefined\n}\n\nfunction parseColumnFilterValue(value: unknown) {\n  if (value === null || value === undefined) {\n    return []\n  }\n\n  if (Array.isArray(value)) {\n    return value.map(item => {\n      if (typeof item === \"number\" || typeof item === \"string\") {\n        return item\n      }\n      return undefined\n    })\n  }\n\n  if (typeof value === \"string\" || typeof value === \"number\") {\n    return [value]\n  }\n\n  return []\n}\n\nexport interface TableDateFilterProps<TData> {\n  column: Column<TData, unknown>\n  title?: string\n  multiple?: boolean\n  trigger?: React.ReactNode\n}\n\nexport function TableDateFilter<TData>({\n  column,\n  title,\n  multiple,\n  trigger,\n}: TableDateFilterProps<TData>) {\n  const columnFilterValue = column.getFilterValue()\n\n  const selectedDates = React.useMemo<DateSelection>(() => {\n    if (!columnFilterValue) {\n      return multiple ? { from: undefined, to: undefined } : []\n    }\n\n    if (multiple) {\n      const timestamps = parseColumnFilterValue(columnFilterValue)\n      return {\n        from: parseAsDate(timestamps[0]),\n        to: parseAsDate(timestamps[1]),\n      }\n    }\n\n    const timestamps = parseColumnFilterValue(columnFilterValue)\n    const date = parseAsDate(timestamps[0])\n    return date ? [date] : []\n  }, [columnFilterValue, multiple])\n\n  const onSelect = React.useCallback(\n    (date: Date | DateRange | undefined) => {\n      if (!date) {\n        column.setFilterValue(undefined)\n        return\n      }\n\n      if (multiple && !(\"getTime\" in date)) {\n        const from = date.from?.getTime()\n        const to = date.to?.getTime()\n        column.setFilterValue(from || to ? [from, to] : undefined)\n      } else if (!multiple && \"getTime\" in date) {\n        column.setFilterValue(date.getTime())\n      }\n    },\n    [column, multiple],\n  )\n\n  const onReset = React.useCallback(\n    (event: React.MouseEvent) => {\n      event.stopPropagation()\n      column.setFilterValue(undefined)\n    },\n    [column],\n  )\n\n  const hasValue = React.useMemo(() => {\n    if (multiple) {\n      if (!getIsDateRange(selectedDates)) return false\n      return selectedDates.from || selectedDates.to\n    }\n    if (!Array.isArray(selectedDates)) return false\n    return selectedDates.length > 0\n  }, [multiple, selectedDates])\n\n  const formatDateRange = React.useCallback((range: DateRange) => {\n    if (!range.from && !range.to) return \"\"\n    if (range.from && range.to) {\n      return `${formatDate(range.from)} - ${formatDate(range.to)}`\n    }\n    return formatDate(range.from ?? range.to)\n  }, [])\n\n  const label = React.useMemo(() => {\n    if (multiple) {\n      if (!getIsDateRange(selectedDates)) return null\n\n      const hasSelectedDates = selectedDates.from || selectedDates.to\n      const dateText = hasSelectedDates\n        ? formatDateRange(selectedDates)\n        : \"Select date range\"\n\n      return (\n        <span className=\"flex items-center gap-2\">\n          <span>{title}</span>\n          {hasSelectedDates && (\n            <>\n              <Separator\n                orientation=\"vertical\"\n                className=\"mx-0.5 data-[orientation=vertical]:h-4\"\n              />\n              <span>{dateText}</span>\n            </>\n          )}\n        </span>\n      )\n    }\n\n    if (getIsDateRange(selectedDates)) return null\n\n    const hasSelectedDate = selectedDates.length > 0\n    const dateText = hasSelectedDate\n      ? formatDate(selectedDates[0])\n      : \"Select date\"\n\n    return (\n      <span className=\"flex items-center gap-2\">\n        <span>{title}</span>\n        {hasSelectedDate && (\n          <>\n            <Separator\n              orientation=\"vertical\"\n              className=\"mx-0.5 data-[orientation=vertical]:h-4\"\n            />\n            <span>{dateText}</span>\n          </>\n        )}\n      </span>\n    )\n  }, [selectedDates, multiple, formatDateRange, title])\n\n  return (\n    <Popover>\n      <PopoverTrigger asChild>\n        {trigger || (\n          <Button variant=\"outline\" size=\"sm\" className=\"h-8 border-dashed\">\n            {hasValue ? (\n              <div\n                role=\"button\"\n                aria-label={`Clear ${title} filter`}\n                tabIndex={0}\n                onClick={onReset}\n                className=\"rounded-sm opacity-70 transition-opacity hover:opacity-100 focus-visible:ring-1 focus-visible:ring-ring focus-visible:outline-none\"\n              >\n                <XCircle className=\"size-4\" />\n              </div>\n            ) : (\n              <CalendarIcon className=\"size-4\" />\n            )}\n            {label}\n          </Button>\n        )}\n      </PopoverTrigger>\n      <PopoverContent className=\"w-auto p-0\" align=\"start\">\n        {multiple ? (\n          <Calendar\n            captionLayout=\"dropdown\"\n            mode=\"range\"\n            selected={\n              getIsDateRange(selectedDates)\n                ? selectedDates\n                : { from: undefined, to: undefined }\n            }\n            onSelect={onSelect}\n          />\n        ) : (\n          <Calendar\n            captionLayout=\"dropdown\"\n            mode=\"single\"\n            selected={\n              !getIsDateRange(selectedDates) ? selectedDates[0] : undefined\n            }\n            onSelect={onSelect}\n          />\n        )}\n      </PopoverContent>\n    </Popover>\n  )\n}\n\n/**\n * @required displayName is required for auto feature detection\n * @see \"feature-detection.ts\"\n */\n\nTableDateFilter.displayName = \"TableDateFilter\"\n",
      "type": "registry:component",
      "target": "components/niko-table/filters/table-date-filter.tsx"
    }
  ],
  "type": "registry:component"
}